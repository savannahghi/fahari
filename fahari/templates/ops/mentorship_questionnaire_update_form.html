{% extends "base.html" %}
{% load crispy_forms_tags %}
{% block title %}
Mentorship teams
{% endblock %}
{% block content %}
    <h1 class="h3 mb-4 text-gray-800">
        Mentorship teams
    </h1>
<div class="card shadow mb-1">
    <div class="card-body">
        <div class="float-right">
            <button data-toggle="modal" data-target="#addTeamMember" class="btn btn-primary btn-icon-split mb-3">
                <span class="icon text-white-50">
                    <i class="fas fa-plus"></i>
                </span>
                <span class="text">Add Team </span>
            </button>
        </div>

        <div class="modal fade" id="addTeamMember" tabindex="-1" aria-labelledby="addTeamMemberLabel"
            aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title font-weight-bold">
                            Add Mentorship Team Member
                        </h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                      <form method="post" action="{% url 'ops:mentorship_team_create' %}" id="save_member">
                            {% csrf_token %}
                            <div class="form-row">
                                <div class="form-group col-md-6 mb-0">
                                    {{ mentorship_questionnaire_update_form.name|as_crispy_field }}
                                </div>
                                <div class="form-group col-md-6 mb-0">
                                    {{ mentorship_questionnaire_update_form.email|as_crispy_field }}
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group col-md-6 mb-0">
                                    {{ mentorship_questionnaire_update_form.phone|as_crispy_field }}
                                </div>
                                <div class="form-group col-md-6 mb-0">
                                    {{ mentorship_questionnaire_update_form.member_org|as_crispy_field }}
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group col-md-6 mb-0">
                                    {{ mentorship_questionnaire_update_form.role|as_crispy_field }}
                                </div>
                            </div>
                            <button id="btnSaveMember" type="submit" class="btn btn-primary">Save</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table table-striped table-sm tbl_team"
              style="width:100%"
              data-server-side="true"
              data-state-save="true"
              data-defer-render="true"
              data-info="true"
              data-page-length="100"
              data-paging-type="full_numbers"
              data-ajax="{% url "api:mentorshipteammember-list" %}?format=datatables&is_qn_team={{object.pk}}">
                <thead class="thead-light">
                    <tr>
                        <th scope="col">Name</th>
                        <th scope="col">Email</th>
                        <th scope="col">Phone</th>
                        <th scope="col">Organisation</th>
                        <th scope="col">Role</th>
                    </tr>
                </thead>
            </table>
            <button type="button" id="btn_next" class="btn btn-primary float-right">Next</button>
        </div>
    </div>
</div>
{% endblock content %}
{% block inline_javascript %}
<script>
    window.addEventListener("load", function () {
        $(document).ready(function () {
        $('.tbl_team').DataTable({
        iDisplayLength: 100,
        responsive: true,
        columns: [
          { data: "name", name: "name" },
          { data: 'email', name: 'email' },
          { data: 'phone', name: 'phone' },
          { data: 'member_org', name: 'member_org'},
          { data: 'role', name: 'role' },
        ]
      });

            function activateNextButton() {
                if (getData("facility") !== null && getData("questionnaire") !== null &&
                    getData("team_members") !== null
                ) {
                    $("#btn_next").removeAttr('disabled');
                } else {
                    $("#btn_next").prop("disabled", true);
                }
            }

        });
    });
</script>
{% endblock inline_javascript %}
